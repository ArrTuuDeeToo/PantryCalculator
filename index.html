<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item Order Summary</title>
    <style>
        /* Previous styles remain the same */
        
        .submit-order {
            background-color: #5865F2 !important; /* Discord blue */
            color: white;
            font-weight: bold;
        }

        .submit-order:hover {
            background-color: #4752C4 !important;
        }

        #webhook-setup {
            margin-top: 10px;
            padding: 10px;
            background-color: #444;
            border-radius: 6px;
        }

        #webhook-setup input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            background-color: #555;
            border: 1px solid #666;
            color: white;
            border-radius: 4px;
        }

        .error-message {
            color: #ff6b6b;
            margin-top: 5px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <!-- Previous HTML remains the same until the order-actions div -->
    
    <!-- In the order-actions div, add the submit button -->
    <div class="order-actions">
        <button onclick="clearOrder()">Clear Order</button>
        <button onclick="saveAsFavorite()">Save as Favorite</button>
        <button onclick="submitOrder()" class="submit-order">Submit to Discord</button>
    </div>

    <!-- Add webhook setup section -->
    <div id="webhook-setup">
        <label for="webhook-url">Discord Webhook URL:</label>
        <input type="text" id="webhook-url" placeholder="Enter your Discord webhook URL">
    </div>

    <script>
        // Previous JavaScript code remains the same

        // Add new function to submit order to Discord
        async function submitOrder() {
            const webhookUrl = document.getElementById('webhook-url').value.trim();
            
            if (!webhookUrl) {
                alert('https://discord.com/api/webhooks/1304933522385010699/_L8gMHmG8VFshVgB4zrINZoX6srFfeoSy7XAtCQS4vhpfJW-Ax2GsbH24UFKCQE4iShy');
                return;
            }

            if (Object.keys(order).length === 0) {
                alert('Please add items to your order first');
                return;
            }

            const discount50 = document.getElementById("discount50").checked;
            const discount5 = document.getElementById("discount5").checked;

            // Calculate total
            let subtotal = Object.values(order).reduce((sum, item) => sum + item.totalPrice, 0);
            if (discount50) subtotal *= 0.5;
            else if (discount5) subtotal *= 0.95;

            // Create order summary
            let orderSummary = Object.entries(order).map(([itemName, item]) => 
                `${item.quantity}x ${itemName} - $${item.totalPrice.toFixed(2)}`
            ).join('\n');

            // Create Discord message
            const message = {
                embeds: [{
                    title: 'ðŸ›’ New Order Received',
                    color: 0x5865F2,
                    fields: [
                        {
                            name: 'ðŸ“‹ Order Details',
                            value: orderSummary
                        },
                        {
                            name: 'ðŸ’° Total',
                            value: `$${subtotal.toFixed(2)}${discount50 ? ' (50% discount applied)' : discount5 ? ' (5% discount applied)' : ''}`
                        }
                    ],
                    timestamp: new Date().toISOString()
                }]
            };

            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(message)
                });

                if (response.ok) {
                    alert('Order submitted successfully!');
                    clearOrder(); // Clear the order after successful submission
                } else {
                    throw new Error('Failed to submit order');
                }
            } catch (error) {
                alert('Error submitting order. Please check your webhook URL and try again.');
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
