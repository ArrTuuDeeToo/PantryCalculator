<script>
    let order = {};
    let favorites = JSON.parse(localStorage.getItem('favorites')) || [];

    updateFavorites();

    // Function to add item to the order
    function addItem(name, price, quantity) {
        if (order[name]) {
            // Update existing item's quantity and total price
            order[name].quantity += quantity;
            order[name].totalPrice += price * quantity;
        } else {
            // Add new item to the order
            order[name] = { 
                quantity: quantity, 
                totalPrice: price * quantity,
                price: price 
            };
        }
        updateOrderSummary();
    }

    // Function to update the order summary with discounts
    function updateOrderSummary() {
        const orderList = document.getElementById("order-list");
        const subtotalDisplay = document.getElementById("subtotal");
        const discount50 = document.getElementById("discount50").checked;
        const discount5 = document.getElementById("discount5").checked;

        orderList.innerHTML = "";
        let subtotal = 0;
        let orderSummaryText = "";

        for (let itemName in order) {
            let item = order[itemName];
            subtotal += item.totalPrice;
            orderSummaryText += `<li>${item.quantity}x ${itemName} - $${item.totalPrice.toFixed(2)}</li>`;
        }

        // Apply discount if any
        if (discount50) {
            subtotal *= 0.5;
        } else if (discount5) {
            subtotal *= 0.95;
        }

        orderList.innerHTML = Object.keys(order).length ? `<ul>${orderSummaryText}</ul>` : "No items added";
        subtotalDisplay.textContent = subtotal.toFixed(2);
    }

    // Clear the order
    function clearOrder() {
        order = {};
        updateOrderSummary();
        document.getElementById("discount50").checked = false;
        document.getElementById("discount5").checked = false;
    }

    // Save the current order as a favorite
    function saveAsFavorite() {
        if (Object.keys(order).length === 0) {
            alert("Please add items to your order first!");
            return;
        }

        const favoriteName = prompt("Enter a name for this favorite order:", "My Favorite Order");
        if (!favoriteName) return;

        const favoriteOrder = {
            name: favoriteName,
            items: {...order},
            discounts: {
                discount50: document.getElementById("discount50").checked,
                discount5: document.getElementById("discount5").checked
            }
        };

        favorites.push(favoriteOrder);
        localStorage.setItem('favorites', JSON.stringify(favorites));
        updateFavorites();
    }

    // Load a saved favorite order
    function loadFavorite(index) {
        const favorite = favorites[index];
        order = {...favorite.items};
        document.getElementById("discount50").checked = favorite.discounts.discount50;
        document.getElementById("discount5").checked = favorite.discounts.discount5;
        updateOrderSummary();
    }

    // Delete a favorite order
    function deleteFavorite(index) {
        favorites.splice(index, 1);
        localStorage.setItem('favorites', JSON.stringify(favorites));
        updateFavorites();
    }

    // Update the favorites list display
    function updateFavorites() {
        const favoritesList = document.getElementById("favorites-list");
        if (favorites.length === 0) {
            favoritesList.innerHTML = "No favorite orders saved";
            return;
        }

        favoritesList.innerHTML = favorites.map((favorite, index) => `
            <div class="favorite-item">
                <span>${favorite.name}</span>
                <div>
                    <button onclick="loadFavorite(${index})">Load Order</button>
                    <button onclick="deleteFavorite(${index})">Delete</button>
                </div>
            </div>
        `).join('');
    }
</script>
